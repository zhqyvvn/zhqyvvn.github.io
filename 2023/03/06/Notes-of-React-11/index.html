<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"zhqyvvn.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.14.1","exturl":false,"sidebar":{"position":"right","display":"always","padding":18,"offset":12,"width":320},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":true,"transition":{"menu_item":"flipInX","post_block":"none","post_header":"flipInX","post_body":"none","coll_header":"flipInX","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="There are three key moments when the Effect Hook can be utilized:  When the component is first added, or mounted, to the DOM and renders When the state or props change, causing the component to re-ren">
<meta property="og:type" content="article">
<meta property="og:title" content="Study Notes of React (11) - The Effect Hook">
<meta property="og:url" content="http://zhqyvvn.github.io/2023/03/06/Notes-of-React-11/index.html">
<meta property="og:site_name" content="Tech Knowledge Sharing">
<meta property="og:description" content="There are three key moments when the Effect Hook can be utilized:  When the component is first added, or mounted, to the DOM and renders When the state or props change, causing the component to re-ren">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-03-06T21:37:17.874Z">
<meta property="article:modified_time" content="2023-03-07T20:38:18.779Z">
<meta property="article:author" content="zhqyvvn">
<meta property="article:tag" content="React">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://zhqyvvn.github.io/2023/03/06/Notes-of-React-11/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://zhqyvvn.github.io/2023/03/06/Notes-of-React-11/","path":"2023/03/06/Notes-of-React-11/","title":"Study Notes of React (11) - The Effect Hook"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Study Notes of React (11) - The Effect Hook | Tech Knowledge Sharing</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-162128119-1"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-162128119-1","only_pageview":false}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>






  <script async defer data-website-id="" src=""></script>

  <script defer data-domain="" src=""></script>

  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Tech Knowledge Sharing</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">zhqyvvn's tech blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-posts"><a href="/archives/" rel="section"><i class="fa fa-book fa-fw"></i>posts</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-folder fa-fw"></i>Categories</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Function-Component-Effects"><span class="nav-text">1. Function Component Effects</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-Clean-Up-Effects"><span class="nav-text">2. Clean Up Effects</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-Control-When-Effects-Are-Called"><span class="nav-text">3. Control When Effects Are Called</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-Fetch-Data"><span class="nav-text">4. Fetch Data</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-Rules-of-Hooks"><span class="nav-text">5. Rules of Hooks</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-Only-call-Hooks-at-the-top-level"><span class="nav-text">5.1. Only call Hooks at the top level</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-Only-call-Hooks-from-React-functions"><span class="nav-text">5.2. Only call Hooks from React functions</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-Separate-Hooks-for-Separate-Effects"><span class="nav-text">6. Separate Hooks for Separate Effects</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Course"><span class="nav-text">Course</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="zhqyvvn"
      src="https://avatars0.githubusercontent.com/u/38484412?s=460&v=4">
  <p class="site-author-name" itemprop="name">zhqyvvn</p>
  <div class="site-description" itemprop="description">"Software and cathedrals are much the same - first we build them, then we pray."</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">60</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/zhqyvvn" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zhqyvvn" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zhqyvvn@gmail.com" title="E-Mail → mailto:zhqyvvn@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="Back to top">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
        <div class="pjax">
        <div class="sidebar-inner sidebar-post-related">
          <div class="animated">
              <div class="links-of-blogroll-title"><i class="fa fa-signs-post fa-fw"></i>
    Related Posts
  </div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <a class="popular-posts-link" href="/2023/02/27/Notes-of-React-9/" rel="bookmark">
        <time class="popular-posts-time">2023-02-27</time>
        <br>
      Study Notes of React (9) - Function Components
      </a>
    </li>
    <li class="popular-posts-item">
      <a class="popular-posts-link" href="/2023/02/14/Notes-of-React-3/" rel="bookmark">
        <time class="popular-posts-time">2023-02-14</time>
        <br>
      Study Notes of React (3) - Class Component
      </a>
    </li>
    <li class="popular-posts-item">
      <a class="popular-posts-link" href="/2023/03/15/Notes-of-React-14/" rel="bookmark">
        <time class="popular-posts-time">2023-03-15</time>
        <br>
      Study Notes of React (14) - Container and Presentational Components
      </a>
    </li>
    <li class="popular-posts-item">
      <a class="popular-posts-link" href="/2023/01/30/Notes-of-React-1/" rel="bookmark">
        <time class="popular-posts-time">2023-01-30</time>
        <br>
      Study Notes of React (1) - JSX
      </a>
    </li>
    <li class="popular-posts-item">
      <a class="popular-posts-link" href="/2023/02/16/Notes-of-React-6/" rel="bookmark">
        <time class="popular-posts-time">2023-02-16</time>
        <br>
      Study Notes of React (6) - this.props
      </a>
    </li>
  </ul>

          </div>
        </div>
        </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://zhqyvvn.github.io/2023/03/06/Notes-of-React-11/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/38484412?s=460&v=4">
      <meta itemprop="name" content="zhqyvvn">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tech Knowledge Sharing">
      <meta itemprop="description" content=""Software and cathedrals are much the same - first we build them, then we pray."">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Study Notes of React (11) - The Effect Hook | Tech Knowledge Sharing">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Study Notes of React (11) - The Effect Hook
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-03-06 16:37:17" itemprop="dateCreated datePublished" datetime="2023-03-06T16:37:17-05:00">2023-03-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-03-07 15:38:18" itemprop="dateModified" datetime="2023-03-07T15:38:18-05:00">2023-03-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Study-Notes/" itemprop="url" rel="index"><span itemprop="name">Study Notes</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Study-Notes/React/" itemprop="url" rel="index"><span itemprop="name">React</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>840</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>There are three key moments when <em>the Effect Hook</em> can be utilized:</p>
<ol>
<li>When the component is first added, or mounted, to the DOM and renders</li>
<li>When the <code>state</code> or <code>props</code> change, causing the component to re-render</li>
<li>When the component is removed, or unmounted, from the DOM.</li>
</ol>
<span id="more"></span>
<p>The <code>useEffect</code> Hook allows us to <strong>replace</strong> repetitive Component Lifecycle code.</p>
<h3 id="1-Function-Component-Effects"><a href="#1-Function-Component-Effects" class="headerlink" title="1. Function Component Effects"></a>1. Function Component Effects</h3><p>Import the Effect Hook from the <code>react</code> library:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>The Effect Hook is used to call another function, so there is nothing returned by the <code>useEffect()</code> function.</p>
<p>The first argument passed to the <code>useEffect()</code> function is the callback function, which is called after each time the component renders. This callback function is referred as <strong>effect</strong>.</p>
<p>For example,</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">title</span> = <span class="string">`Hi, <span class="subst">$&#123;name&#125;</span>`</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>The effect has access to the variables in the scope of the function component.</p>
<h3 id="2-Clean-Up-Effects"><a href="#2-Clean-Up-Effects" class="headerlink" title="2. Clean Up Effects"></a>2. Clean Up Effects</h3><p>If the effect returns a function, then the <code>useEffect()</code> Hook always treats it as a <strong>cleanup</strong> function. </p>
<p>React calls the cleanup function before each re-render and before unmounting.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;keydown&#x27;</span>, handleKeyPress);</span><br><span class="line">  <span class="comment">// Specify how to clean up after the effect:</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;keydown&#x27;</span>, handleKeyPress);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>In the above code, if the effect didn’t return a cleanup function, then a new event listener would be added to the DOM’s document object every time the component re-renders, which would cause memory leak.</p>
<h3 id="3-Control-When-Effects-Are-Called"><a href="#3-Control-When-Effects-Are-Called" class="headerlink" title="3. Control When Effects Are Called"></a>3. Control When Effects Are Called</h3><p>To only call the effect after the first render, we can pass an empty array to <code>useEffect()</code> as the second argument. This second argument is called the <strong>dependency array</strong>.</p>
<p>The dependency array is used to tell the <code>useEffect()</code> method when to call the effect and when to skip it. The effect is always called after the first render but only called again if values in the dependency array has changed between renders.</p>
<p>The empty dependency array makes an effect called only when a component first mounts, and if the effect returns a cleanup function, makes the cleanup function called when the component unmounts.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&quot;component rendered for the first time&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;component is being removed from the DOM&quot;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;, []); </span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>Dependency Array</th>
<th>Effect called after first render &amp; …</th>
</tr>
</thead>
<tbody><tr>
<td>undefined</td>
<td>every re-render</td>
</tr>
<tr>
<td>Empty array</td>
<td>no re-renders</td>
</tr>
<tr>
<td>Non-empty array</td>
<td>when any value in the dependency array changes</td>
</tr>
</tbody></table>
<h3 id="4-Fetch-Data"><a href="#4-Fetch-Data" class="headerlink" title="4. Fetch Data"></a>4. Fetch Data</h3><p>When the effect is responsible for fetching data from a server, unnecessary round trips back and forth between the React components and the server can be costly in terms of:</p>
<ul>
<li>Processing</li>
<li>Performance</li>
<li>Data usage for mobile users</li>
<li>API service fees</li>
</ul>
<p>When the response is received from the server, we can use a state setter from the State Hook to store the data from the server’s response in the local component state for future renders. </p>
<p>For a dependency array that is not empty, only when its value changes, the Effect Hook calls the effect again.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&#x27;Requested data from server...&#x27;</span>);</span><br><span class="line">  <span class="title function_">get</span>(forecastType).<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">setData</span>(response.<span class="property">data</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;, [forecastType]);</span><br></pre></td></tr></table></figure>

<h3 id="5-Rules-of-Hooks"><a href="#5-Rules-of-Hooks" class="headerlink" title="5. Rules of Hooks"></a>5. Rules of Hooks</h3><p>There are two main rules to keep in mind when using Hooks:</p>
<h4 id="5-1-Only-call-Hooks-at-the-top-level"><a href="#5-1-Only-call-Hooks-at-the-top-level" class="headerlink" title="5.1. Only call Hooks at the top level"></a>5.1. Only call Hooks at the top level</h4><p>Call the Hooks at the top level; Never call Hooks inside of loops, conditions, or nested functions.</p>
<p>Instead of code like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (userName !== <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;savedUserName&#x27;</span>, userName);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Move the condition inside:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (userName !== <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;savedUserName&#x27;</span>, userName);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="5-2-Only-call-Hooks-from-React-functions"><a href="#5-2-Only-call-Hooks-from-React-functions" class="headerlink" title="5.2. Only call Hooks from React functions"></a>5.2. Only call Hooks from React functions</h4><p>Hooks can only be used in React Functions. We cannot use Hooks in Class Components and we cannot use Hooks in regular JavaScript functions.</p>
<p>The only other place where Hooks can be used is within <a target="_blank" rel="noopener" href="https://reactjs.org/docs/hooks-custom.html"><em>custom hooks</em></a>.</p>
<h3 id="6-Separate-Hooks-for-Separate-Effects"><a href="#6-Separate-Hooks-for-Separate-Effects" class="headerlink" title="6. Separate Hooks for Separate Effects"></a>6. Separate Hooks for Separate Effects</h3><p>Packaging data together can add complexity to the code responsible for managing that data. Therefore, it is a good idea to separate concerns by managing different data with different Hooks.</p>
<p>Compare the complexity here, where data is bundled up into a single object:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Handle both position and menuItems with one useEffect hook.</span></span><br><span class="line"><span class="keyword">const</span> [data, setData] = <span class="title function_">useState</span>(&#123; <span class="attr">position</span>: &#123; <span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span> &#125; &#125;);</span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">get</span>(<span class="string">&#x27;/menu&#x27;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">setData</span>(<span class="function">(<span class="params">prev</span>) =&gt;</span> (&#123; ...prev, <span class="attr">menuItems</span>: response.<span class="property">data</span> &#125;));</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleMove</span> = (<span class="params">event</span>) =&gt;</span><br><span class="line">    <span class="title function_">setData</span>(<span class="function">(<span class="params">prev</span>) =&gt;</span> (&#123;</span><br><span class="line">      ...prev,</span><br><span class="line">      <span class="attr">position</span>: &#123; <span class="attr">x</span>: event.<span class="property">clientX</span>, <span class="attr">y</span>: event.<span class="property">clientY</span> &#125;</span><br><span class="line">    &#125;));</span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, handleMove);</span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, handleMove);</span><br><span class="line">&#125;, []);</span><br></pre></td></tr></table></figure>

<p>To the simplicity here, where we have separated concerns:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Handle menuItems with one useEffect hook.</span></span><br><span class="line"><span class="keyword">const</span> [menuItems, setMenuItems] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">get</span>(<span class="string">&#x27;/menu&#x27;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> <span class="title function_">setMenuItems</span>(response.<span class="property">data</span>));</span><br><span class="line">&#125;, []);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// Handle position with a separate useEffect hook.</span></span><br><span class="line"><span class="keyword">const</span> [position, setPosition] = <span class="title function_">useState</span>(&#123; <span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span> &#125;);</span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleMove</span> = (<span class="params">event</span>) =&gt;</span><br><span class="line">    <span class="title function_">setPosition</span>(&#123; <span class="attr">x</span>: event.<span class="property">clientX</span>, <span class="attr">y</span>: event.<span class="property">clientY</span> &#125;);</span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, handleMove);</span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, handleMove);</span><br><span class="line">&#125;, []);</span><br></pre></td></tr></table></figure>

<p>Another complex example:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [data, setData] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title class_">Promise</span>.<span class="title function_">all</span>([<span class="title function_">get</span>(<span class="string">&#x27;/menu&#x27;</span>), <span class="title function_">get</span>(<span class="string">&#x27;/news-feed&#x27;</span>), <span class="title function_">get</span>(<span class="string">&#x27;/friends&#x27;</span>)]).<span class="title function_">then</span>(</span><br><span class="line">    <span class="function">(<span class="params">[menuResponse, newsFeedResponse, friendsResponse]</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setData</span>(&#123;</span><br><span class="line">        <span class="attr">menu</span>: menuResponse.<span class="property">data</span>,</span><br><span class="line">        <span class="attr">newsFeed</span>: newsFeedResponse.<span class="property">data</span>,</span><br><span class="line">        <span class="attr">friends</span>: friendsResponse.<span class="property">data</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">&#125;, []);</span><br></pre></td></tr></table></figure>

<p>Split the above bundled <code>Promise</code> group into different Effect Hook:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [menu, setMenu] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">get</span>(<span class="string">&#x27;/menu&#x27;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">menuResponse</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">setMenu</span>(menuResponse.<span class="property">data</span>);</span><br><span class="line">  &#125;);  </span><br><span class="line">&#125;, []);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> [newsFeed, setNewsFeed] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">get</span>(<span class="string">&#x27;/news-feed&#x27;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">newsFeedResponse</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">setNewsFeed</span>(newsFeedResponse.<span class="property">data</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;, [])</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> [friends, setFriends] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">get</span>(<span class="string">&#x27;/friends&#x27;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">friendsResponse</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">setFriends</span>(friendsResponse.<span class="property">data</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;, [])</span><br></pre></td></tr></table></figure>

<h3 id="Course"><a href="#Course" class="headerlink" title="Course"></a>Course</h3><p><a target="_blank" rel="noopener" href="https://www.codecademy.com/learn/react-101">Learn React</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/React/" rel="tag"><i class="fa fa-tag"></i> React</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/03/14/Notes-of-React-12/" rel="prev" title="Study Notes of React (12) - Stateful and Stateless Components">
                  <i class="fa fa-chevron-left"></i> Study Notes of React (12) - Stateful and Stateless Components
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/02/28/Notes-of-React-10/" rel="next" title="Study Notes of React (10) - The State Hook">
                  Study Notes of React (10) - The State Hook <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2018 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zhqyvvn</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>Word count total: </span>
    <span title="Word count total">58k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>Reading time total &asymp;</span>
    <span title="Reading time total">4:51</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/pace.js"></script>

  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"zhqyvvn","repo":"zhqyvvn.github.io","client_id":"c28a59a6f171f3e27313","client_secret":"a31ffbb812ba7a28cd66045ae2a68e017e9d539f","admin_user":"zhqyvvn","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":null,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"cb39297760e71d7b242ca4bd8ea1ed3c"}</script>
<script src="/js/third-party/comments/gitalk.js"></script>

</body>
</html>
